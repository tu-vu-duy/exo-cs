<%
	import org.exoplatform.calendar.service.GroupCalendarData;
	def rcontext = _ctx.getRequestContext() ;
  rcontext.getJavascriptManager().addJavascript('eXo.calendar.UICalendarPortlet.checkLayout() ;') ;
%>
<div class="UICalendars" >
<%uiform.begin()%>
	<div class="TitleBar">
		<div class="Title">Calendars</div>
		<div class="ActionsButton" title="Calendar actions" onclick="eXo.calendar.UICalendarPortlet.showMainMenu(this, event);">
			<% /*Begin Popup Menu - Main */ %>
	     
			        <div class="UIRightClickPopupMenu" style="display: none ;">
			        	<div class="UIContextMenuContainer">
								  <div class="TopLeftRightClickPopupMenu">
		          			<div class="TopRightRightClickPopupMenu">
		            			<div class="TopCenterRightClickPopupMenu"><span></span></div>
		          			</div>
		        			</div>
					        <div class="MiddleLeftRightClickPopupMenu">
					          <div class="MiddleRightRightClickPopupMenu">
		              		<div class="UIRightPopupMenuContainer">
			                   <a class="MenuItem" href="<%=uicomponent.event("AddCalendarCategory")%>">   
			                    <div class="ItemIcon AddGroupIcon">
			                      Add group
			                    </div>
			                   </a>
			                   <a class="MenuItem" href="<%=uicomponent.event("AddCalendar")%>">   
			                    <div class="ItemIcon AddCalendarIcon">
			                      Add calendar
			                    </div>
			                   </a>
			                   <a class="MenuItem" href="<%=uicomponent.event("ImportCalendar")%>">   
			                    <div class="ItemIcon ImportCalendarIcon">
			                      Import calendar
			                    </div>
			                   </a>
			                   <a class="MenuItem" href="<%=uicomponent.event("GenerateRss")%>">   
			                    <div class="ItemIcon GenerateRssIcon">
			                      Generate RSS
			                    </div>
			                   </a>
			                   <a class="MenuItem" href="<%=uicomponent.event("CalendarSetting")%>">   
			                    <div class="ItemIcon SettingCalendarIcon">
			                      Calendar setting
			                    </div>
			                   </a>
		              		</div>
		          			</div>
		        			</div>
					        <div class="BottomLeftRightClickPopupMenu">
				          <div class="BottomRightRightClickPopupMenu">
				            <div class="BottomCenterRightClickPopupMenu"><span></span></div>
				          </div>
				        </div>
	      				</div>
	      			</div>
	      		
			<% /*End Popup Menu*/ %>
		</div>
		<div style="clear: both"><span></span></div>
	</div>
	<div class="ContentContainer">
	<!-- start private calendars -->
		<div class="MyCalendar">
			<div class="CalendarTitle">
				<div class="CollapserFlatStyle" title="Collapser my calendar"><span></span></div>
				<div class="Label">My calendars</div>
			</div>
			<div class="MyCalendarContainer">
				<%
					List groupCalendars = uicomponent.getPrivateCalendars() ;
					for(groupData in groupCalendars) {
				%>
				<div class="UIVTab">  	
  				<div class="CalendarSelectedFlatStyle">
  					<div class="GroupItem">
  						<div class="GroupColor1">
  							<div title="Collapser calendar group" class="CollapserFlatStyle"><span></span></div>
  							<div class="CheckBox"><input type="checkbox" onclick="eXo.calendar.UICalendarPortlet.filterByGroup(this) ;"/></div>
  							<div class="CalendarGroupIcon" onclick=""><a href="#" >$groupData.name</a></div>
  							<div class="DownArrow1Icon"  id="$groupData.id" onclick="eXo.calendar.UICalendarPortlet.show(this, event);"><span></span></div>
  							<div style="clear: both"><span></span></div>
  						</div>
  					</div>
  				</div>
  				<div class="UIVTabContent" >
				<%	
						List calendars = groupData.getCalendars() ;
						for(calendar in calendars) {
						String calId = calendar.getId() ;
				%>
  					<div class="CalendarItem">
  						<div class="$calendar.calendarColor">
  							<div class="CheckBox" onclick="eXo.calendar.UICalendarPortlet.initFilter(this,1) ;"><%uiform.renderField(calId)%></div>
  							<div class="CalendarIcon"><a href="#" >$calendar.name</a></div>
  							<div class="DownArrow1Icon"  calColor="$calendar.calendarColor" id="$calId" calType="0" title="Calendar actions" onclick="eXo.calendar.UICalendarPortlet.show(this, event);"><span></span></div>
  							<div style="clear: both"><span></span></div>
  						</div>
  					</div>
				<%
						}
				%>
					</div>
				</div>	
				<%
					}
				%>  				
			</div>
		</div>
		<!-- end private calendars -->
		<!-- shared calendars -->
		<div class="MyCalendar">
			<div class="CalendarTitle">
				<div class="CollapserFlatStyle" title="Collapser my calendar"><span></span></div>
				<div class="Label">Shared calendars</div>
			</div>
			<div class="MyCalendarContainer">
				<%
					GroupCalendarData sharedCalendars = uicomponent.getSharedCalendars() ;
					if(sharedCalendars != null) {
				%>
				<div class="UIVTab">  	
  				<div class="UIVTabContent" >
				<%	
						List calendarList = sharedCalendars.getCalendars() ;
						for(calendar in calendarList) {
						calId = calendar.getId() ;
				%>
  					<div class="CalendarItem">
  						<div class="$calendar.calendarColor">
  							<div class="CheckBox" onclick="eXo.calendar.UICalendarPortlet.initFilter(this,1) ;"><%uiform.renderField(calendar.getId())%></div>
  							<div class="CalendarIcon"><a href="#" ><%=calendar.getName()%></a></div>
  							<div class="DownArrow1Icon" calColor="$calendar.calendarColor" id="$calId" calType="1" title="Calendar actions" onclick="eXo.calendar.UICalendarPortlet.show(this, event);"><span></span></div>
  							<div style="clear:both;"><span></span></div>
  						</div>
  					</div>
				<%
						}
				%>
					</div>
				</div>	
				<%
					}
				%>  				
			</div>
		</div>
		<!-- end shared calendars -->
		<!-- start public calendars -->
		<div class="MyCalendar">
			<div class="CalendarTitle">
				<div class="CollapserFlatStyle" title="Collapser my calendar"><span></span></div>
				<div class="Label">Public calendars</div>
			</div>
			<div class="MyCalendarContainer">
				<%
					List publicCalendars = uicomponent.getPublicCalendars() ;
					for(groupData in publicCalendars) {
				%>
				<div class="UIVTab">  	
  				<div class="CalendarSelectedFlatStyle">
  					<div class="GroupItem">
  						<div class="GroupColor1">
  							<div title="Collapser calendar group" class="CollapserFlatStyle"><span></span></div>
  							<div class="CheckBox"><input type="checkbox" onclick="eXo.calendar.UICalendarPortlet.filterByGroup(this) ;"/></div>
  							<div class="CalendarGroupIcon" onclick=""><a href="#" ><%=groupData.getName()%></a></div>
  							<div style="clear: both"><span></span></div>
  						</div>
  					</div>
  				</div>
  				<div class="UIVTabContent" >
				<%	
						List calendarList = groupData.getCalendars() ;
						for(calendar in calendarList) {
							calId = calendar.getId() ;
				%>
  					<div class="CalendarItem">
  						<div class="$calendar.calendarColor">
  							<div class="CheckBox" onclick="eXo.calendar.UICalendarPortlet.initFilter(this,1) ;"><%uiform.renderField(calendar.getId())%></div>
  							<div class="CalendarIcon"><a href="#" ><%=calendar.getName()%></a></div>
  							<div class="DownArrow1Icon" calColor="$calendar.calendarColor" id="$calId" calType="2" title="Calendar actions" onclick="eXo.calendar.UICalendarPortlet.show(this, event);"><span></span></div>
  							<div style="clear: both"><span></span></div>
  						</div>
  					</div>
				<%
						}
				%>
					</div>
				</div>	
				<%
					}
				%>  				
			</div>
		</div>
		<!-- end public calendars -->
	</div>
	<% /*Begin Popup Menu - Calendar group*/ %>
	      <div class="UIPopupCategory" style="display: none; z-index: 10000 ;">
	      	<div class="PopupCategoryDecorator">
	      
		        <div class="UIRightClickPopupMenu" style="display: block;">
		        	<div class="UIContextMenuContainer">
							  <div class="TopLeftRightClickPopupMenu">
		      			<div class="TopRightRightClickPopupMenu">
		        			<div class="TopCenterRightClickPopupMenu"><span></span></div>
		      			</div>
		    			</div>
				        <div class="MiddleLeftRightClickPopupMenu">
				          <div class="MiddleRightRightClickPopupMenu">
		          		<div class="UIRightPopupMenuContainer">
		          				 <a class="MenuItem" href="<%=uicomponent.event("AddCalendar","id")%>">   
		                    <div class="ItemIcon AddCalendarIcon">
		                      Add calendar
		                    </div>
		                   </a>
		          				<a class="MenuItem" href="<%=uicomponent.event("EditGroup","id")%>">   
		                    <div class="ItemIcon AddEventIcon">
		                      Edit group
		                    </div>
		                   </a>	
		                   <a class="MenuItem" href="<%=uicomponent.event("DeleteGroup","id")%>">   
		                    <div class="ItemIcon AddEventIcon">
		                      Delete group
		                    </div>
		                   </a>	
		                   <a class="MenuItem" href="<%=uicomponent.event("ImportCalendar")%>">   
		                    <div class="ItemIcon ImportCalendarIcon">
		                      Import calendar
		                    </div>
		                   </a>
		                   <a class="MenuItem" href="<%=uicomponent.event("ExportCalendars","id")%>">   
		                    <div class="ItemIcon ExportCalendarIcon">
		                      Export Calendar
		                    </div>
		                   </a>
		          		</div>
		      			</div>
		    			</div>
				        <div class="BottomLeftRightClickPopupMenu">
			          <div class="BottomRightRightClickPopupMenu">
			            <div class="BottomCenterRightClickPopupMenu"><span></span></div>
			          </div>
			        </div>
	  					</div>
	  				</div>
	  			
			    </div>
			  </div>
		<% /*End Popup Menu*/ %>
	<% /*Begin Popup Menu - Calendar*/ %>
<!--	  <div style="position: relative;">-->
	      <div class="UIPopupCategory" style="display: none; z-index: 10000 ;">
	      	<div class="PopupCategoryDecorator">
	      
		        <div class="UIRightClickPopupMenu" style="display: block;">
		        	<div class="UIContextMenuContainer">
							  <div class="TopLeftRightClickPopupMenu">
		      			<div class="TopRightRightClickPopupMenu">
		        			<div class="TopCenterRightClickPopupMenu"><span></span></div>
		      			</div>
		    			</div>
				        <div class="MiddleLeftRightClickPopupMenu">
				          <div class="MiddleRightRightClickPopupMenu">
		          		<div class="UIRightPopupMenuContainer" >
		                   <a class="MenuItem" href="<%=uicomponent.event("AddEvent","id")%>">   
		                    <div class="ItemIcon AddNewEvent">
		                      Add event
		                    </div>
		                   </a>
		                   <a class="MenuItem" href="<%=uicomponent.event("AddTask","id")%>">   
		                    <div class="ItemIcon AddNewTask">
		                      Add task
		                    </div>
		                   </a>
		                   <a class="MenuItem" href="<%=uicomponent.event("EditCalendar","id")%>">   
		                    <div class="ItemIcon  EditCalendarIcon">
		                      Edit Calendar
		                    </div>
		                   </a>
		                   <a class="MenuItem" href="<%=uicomponent.event("RemoveCalendar","id")%>">   
		                    <div class="ItemIcon RemoveCalendarIcon">
		                      Remove Calendar
		                    </div>
		                   </a>
		                   <a class="MenuItem" href="<%=uicomponent.event("ExportCalendar","id")%>">   
		                    <div class="ItemIcon ExportCalendarIcon">
		                      Export Calendar
		                    </div>
		                   </a>
		                   <a class="MenuItem" style="color: gray;">   
		                    <div class="ItemIcon  SendMailCalendarIcon">
		                      Send to friend
		                    </div>
		                   </a>
		                   <a class="MenuItem" href="<%=uicomponent.event("ShareCalendar","id")%>">   
		                    <div class="ItemIcon  SharedCalendarIcon">
		                      Shared calendar
		                    </div>
		                   </a>		
		          		</div>
		          			<div class="CalendarTableColor" >
											<%
												for(color in uicomponent.getColors()) {
												actionLink = uicomponent.event("ChangeColor","id&calColor="+color);
											%>
												<a href="$actionLink" class="$color ColorCell"><div><span></span></div></a>
											<%}%>
										<div style="clear:left;"><span></span></div>
									</div>
		      			</div>
		    			</div>
				        <div class="BottomLeftRightClickPopupMenu">
			          <div class="BottomRightRightClickPopupMenu">
			            <div class="BottomCenterRightClickPopupMenu"><span></span></div>
			          </div>
			        </div>
	  					</div>
	  				</div>
	  			
			    </div>
			  </div>
<!--			</div>-->
		<% /*End Popup Menu*/ %>
<%uiform.end()%>
</div>