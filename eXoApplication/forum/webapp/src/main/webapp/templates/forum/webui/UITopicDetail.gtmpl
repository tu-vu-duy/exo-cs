<%  
	import org.exoplatform.forum.webui.UIPostRules ;
	import org.exoplatform.forum.webui.UIForumLinks ;
	import org.exoplatform.forum.service.Post ;
	import org.exoplatform.forum.service.Topic ;
%>
<%  
	Topic topic = uicomponent.getTopicDetail() ;
%>

<div class="UITopicDetail">
<% uiform.begin() %>
	<% if(topic != null) {%>
	<div class="ButtomAndPageListContainer">
	<% if(topic.getIsLock()) { %>
		<div class="LockActionForum UIActionForum" style="float: left;">
	<% } else { %>
		<div class="UIActionForum" style="float: left;">
	<% } %>
		  <div class="ActionButton">
		  	<div class="NormalStyle">
		  		<div class="ButtonLeft">
		  			<div class="ButtonRight">
		  				<div class="ButtonMiddle">
		  				<% if(topic.getIsLock()) { %>
		  						<div class="IconButton LockIcon" title="You can not reply this thread."><span class="LockLabel"></span>Post Reply</div>
		  				<% } else { %>
		  					<a href="<%=uicomponent.event("AddPost")%>">
		  						<div class="IconButton PostReplyIcon"><span class="LabelIcon"></span>
		  							<%=_ctx.appRes(uicomponent.getName() + ".action.AddPost");%>
									</div>
		  					</a>
		  				<% } %>
		  					</a>
		  				</div>
		  			</div>
		  		</div>
		  	</div>
		  </div>
		</div>
		<div class="UIPageIterator1" style="margin-left: 120px; width: auto;border: solid 1px red; line-height: 20px;">
			UIPageIterator
		</div>
		<div style="clear: left;"><span></span></div>
	</div>
<!-- Start PostsInThreadContainer -->	
	<div class="PostsInThreadContainer">
	  <div class="ForumToolbar">
		  <div class="LeftBar">
		  	<div class="RightBar">
		  		<div class="CenterBar">
		  			<div class="ToolbarActionsContainer">
		  				<div class="StatusIcon ModerationIcon" onclick="eXo.webui.UIPopupSelectCategory.show(this, event);">
								<a class="DownArrow1Icon">Moderation</a>
								<% /*Begin Popup Menu*/ %>
								<div style="position: relative;">
			      			<div class="UIPopupCategory" style="display: none; ">
			      				<div class="UIRightClickPopupMenu" style="display: block; left: -70px;">
			      					<div class="UIContextMenuContainer">
											  <div class="TopLeftRightClickPopupMenu">
					          			<div class="TopRightRightClickPopupMenu">
					            			<div class="TopCenterRightClickPopupMenu"><span></span></div>
					          			</div>
					        			</div>
								        <div class="MiddleLeftRightClickPopupMenu">
								          <div class="MiddleRightRightClickPopupMenu">
					              		<div class="UIRightPopupMenuContainer">
														<%  
															String[] actionMenuPost = ["MergePost", "MovePost", "SetApprovePost", "SetUnApprovePost", "SetApproveAttachment", "SetUnApproveAttachment", "DeletePost"];
															for( action in actionMenuPost ) {
																String link = uicomponent.event(action) ;
																String classIcon = action + "Icon";
					                   		String itemLabel = _ctx.appRes(uicomponent.getName() + ".action." + action);
														%>
															<a class="MenuItem" href="$link">   
						                    <div class="ItemIcon $classIcon">
						                      $itemLabel
						                    </div>
					                    </a>
					                    <% } %>
														</div>
						          		</div>
						        		</div>
									      <div class="BottomLeftRightClickPopupMenu">
								        <div class="BottomRightRightClickPopupMenu">
								          <div class="BottomCenterRightClickPopupMenu"><span></span></div>
								        </div>
								      </div>
					      			</div>
								    </div>
			      			</div>
			      		</div>
			      		<% /*End Popup Menu*/ %>
		  				</div>
		  				<div class="SeparatorLine"><span></span></div>
							<a class="StatusIcon TagIcon">Tag</a>
		  				<div class="SeparatorLine"><span></span></div>
							<a class="StatusIcon VoteIcon" href="<%=uicomponent.event("RatingTopic");%>">Vote Thread</a>
		  				<div class="SeparatorLine"><span></span></div>
							<a class="StatusIcon SearchIcon">Search Thread</a>
		  				<div class="SeparatorLine"><span></span></div>
		  				<div class="StatusIcon ToolIcon" onclick="eXo.webui.UIPopupSelectCategory.show(this, event);">
								<a class="DownArrow1Icon">Thread Tools</a>
								<% /*Begin Popup Menu*/ %>
								<div style="position: relative;">
			      			<div class="UIPopupCategory" style="display: none; ">
			      				<div class="UIRightClickPopupMenu" style="display: block;">
			      					<div class="UIContextMenuContainer">
											  <div class="TopLeftRightClickPopupMenu">
					          			<div class="TopRightRightClickPopupMenu">
					            			<div class="TopCenterRightClickPopupMenu"><span></span></div>
					          			</div>
					        			</div>
								        <div class="MiddleLeftRightClickPopupMenu">
								          <div class="MiddleRightRightClickPopupMenu">
					              		<div class="UIRightPopupMenuContainer">
															<% 
															String[] menuTopicActions = ["EditTopic", "PrintPage", "AddPoll", "SetOpenTopic", "SetCloseTopic", 
															"SetLockedTopic", "SetUnLockTopic", "SetStickTopic", "SetUnStickTopic", "SplitTopic", 
															"SetApproveTopic", "SetUnApproveTopic", "SetMoveTopic", "SetDeleteTopic"] ;
					                   		for(action in menuTopicActions) {
					                   			if(topic.getIsPoll()){
					                   				if(action.equals("AddPoll")) continue ;
					                   			}
					                   			String link = uicomponent.event(action) ;
						                   		String itemLabel = _ctx.appRes(uicomponent.getName() + ".action." + action);
						                   		String classIcon = null;
						                   		if(action.length() < 11) classIcon = action + "Icon";
						                   		else classIcon = action.replaceFirst("Topic", "Icon");
					                   %>
					                    <a class="MenuItem" href="$link">   
						                    <div class="ItemIcon $classIcon">
						                      $itemLabel
						                    </div>
					                    </a>
					                   <% } %>
														</div>
						          		</div>
						        		</div>
									      <div class="BottomLeftRightClickPopupMenu">
								        <div class="BottomRightRightClickPopupMenu">
								          <div class="BottomCenterRightClickPopupMenu"><span></span></div>
								        </div>
								      </div>
					      			</div>
								    </div>
			      			</div>
			      		</div>
			      		<% /*End Popup Menu*/ %>
		  				</div>
		  				<div style="clear: right;"><span></span></div>
						</div>
		  		</div>
		  	</div>
		  </div>
	  </div>
	  
<!-- Start ContentContainer -->

		<%  
			List posts = uicomponent.getPostPageList(1) ;
			for(post in posts) {
				String owner = post.getOwner() ;
				String classIconPost = post.getIcon() ;
				if(classIconPost.length() <= 0) 
					classIconPost = "NormalTopicIcon" ;
				String subject = post.getSubject() ;
				String createdDate = post.getCreatedDate().toString() ;
				String messager = post.getMessage() ;
				String editBy = post.getModifiedBy() ;
				String editDate = post.getModifiedDate().toString() ;
		%>

	  <div class="ContentContainer" style="margin: 2px 0px 0px 0px;">
		  <table class="TablePost" cellspacing="0" borderspacing="0">
		  	<tbody>
		  		<tr>
<!-- Start MemberContainer -->	  
						<td class="MemberContainer">
				  		<div class="MemberContent">
					  		<div class="MemberName">
					  			<div class="State AvailableIcon" title="Phuongï¿½s Available"><span></span></div>
					  			<div class="Name">$owner</div>
					  			<div class="Action"><span></span></div>
					  			<div style="clear: left;"><span></span></div>
					  		</div>
					  		<div class="Rank">Junior Member</div>
					  		<img src="/forum/skin/DefaultSkin/webui/background/Avatar1.gif" class="Img" />
					  		<div class="InfoMember">
					  			<div>Join Date: Feb 2006</div>
									<div>Posts: 150</div>
									<div>Location: Hanoi, Vietnam</div>
					  		</div>
					  	</div>
					  </td>
	<!-- End MemberContainer -->
	
	
	<!-- Start PostViewContainer -->
						<td class="PostViewContainer">
					  	
				  		<div class="PostViewHeader">
				  			<div class="PostViewTitle" style="float: left;">
					  			<div class="PostViewIcon $classIconPost">$subject</div>
					  			<div class="PostTime">Posted: $createdDate</div>
					  		</div>
					  		<div class="CheckPost" style="float: right;">
					  			<% uiform.renderChild(post.getId()) %>
					  		</div>
					  		<div style="clear: both;"><span></span></div>
				  		</div>
				  		
				  		<div class="PostContent">
				  			<br><div>$messager</div><br>
				  		</div>
				  		
				  		<div class="AttachmentContainer">
				  			<div class="AttachmentTitle">Attachments:</div>
				  			<div class="AttachmentContent">
				  				<div class="AttachmentBox">
										<div class="AttachmentIcon WordIcon"><span></span></div>
										<a href="#" class="AttachmentLabel">About the trip.doc</a>
										<div style="clear: left;"><span></span></div>
										<div class="Size">Size: 49K</div>
				  				</div>
				  				<div class="AttachmentBox">
										<div class="AttachmentIcon PPTIcon"><span></span></div>
										<a href="#" class="AttachmentLabel" >Images presentation.ppt</a>
										<div style="clear: left;"><span></span></div>
										<div class="Size">Size: 49K</div>
				  				</div>
				  				<div style="clear: left;"><span></span></div>
				  			</div>
				  		</div>
				  		
				  		<div class="FootPost">
				  			<div class="PostInfo">
					  			<div>Last edited by <a href="#">$editBy</a> on $editDate</div>
									<div>Reason: Add new</div>
								</div>
								<div class="ButtonContainer">
									<div class="UIActionForum">
									<%
										String[] actions = ["Print", "Edit", "Delete", "Quote"] ; 
										for(action in actions) {
											String title = _ctx.appRes(uicomponent.getName() + ".title." + action);
											String label = _ctx.appRes(uicomponent.getName() + ".action." + action);
											if(topic.getIsLock()&&(action.equals("Edit")||action.equals("Quote"))) continue ;
									%>
									  <div class="ActionButton">
									  	<div class="NormalStyle">
									  		<div class="ButtonLeft">
									  			<div class="ButtonRight">
									  				<div class="ButtonMiddle">
									  					<a href="<%=uicomponent.event(action, post.getId());%>">
									  						<div class="IconButton ${action}PostIcon" title="$title"><span class="LabelIcon"></span>$label</div>
									  					</a>
									  				</div>
									  			</div>
									  		</div>
									  	</div>
									  </div>
									  <% } %>
									</div>
								</div>
								<div style="clear: both"><span></span></div>
				  		</div>
					  		
					  </td>
	<!-- End PostViewContainer-->
					</tr>
				</tbody>
      </table>
	  </div>
	  <% } %>
<!-- End ContentContainer -->

	</div>	
<!-- End PostsInThreadContainer -->
	<div class="ButtomAndPageListContainer">
		<% if(topic.getIsLock()) { %>
		<div class="LockActionForum UIActionForum" style="float: left;">
	<% } else { %>
		<div class="UIActionForum" style="float: left;">
	<% } %>
		  <div class="ActionButton">
		  	<div class="NormalStyle">
		  		<div class="ButtonLeft">
		  			<div class="ButtonRight">
		  				<div class="ButtonMiddle">
		  				<% if(topic.getIsLock()) { %>
		  						<div class="IconButton LockIcon" title="You can not reply this thread."><span class="LockLabel"></span>Post Reply</div>
		  				<% } else { %>
		  					<a href="<%=uicomponent.event("AddPost")%>">
		  						<div class="IconButton PostReplyIcon"><span class="LabelIcon"></span>
		  							<%=_ctx.appRes(uicomponent.getName() + ".action.AddPost");%>
									</div>
		  					</a>
		  				<% } %>
		  					</a>
		  				</div>
		  			</div>
		  		</div>
		  	</div>
		  </div>
		</div>
		<div class="UIPageIterator1" style="margin-left: 120px; width: auto;border: solid 1px red; line-height: 20px;">
			UIPageIterator  g
		</div>
		<div style="clear: left;"><span></span></div>
	</div>
	<% } else { %>
	
		Topic da bi xoa hoac da bi chuyen di !
	
	<% } %>
<%uiform.end()%>
<% uicomponent.renderChild(UIPostRules.class) %>
<% uicomponent.renderChild(UIForumLinks.class) %>
</div>
